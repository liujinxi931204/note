redis cluster是redis的分布式解决方案  
### redis数据分区  
redis cluster采用虚拟槽分区，所有的键根据哈希函数映射到0~16383整数槽内，计算公式：slot=CRC16(key)&16383  
每个节点维护一部分槽以及槽所映射的键值数据  
![title](https://raw.githubusercontent.com/liujinxi931204/image/master/gitnote/2020/10/12/1602487937165-1602487937167.png)  
![title](https://raw.githubusercontent.com/liujinxi931204/image/master/gitnote/2020/10/12/1602487971287-1602487971288.png)  
redis虚拟槽分区的特点  
+ 解耦数据和节点之间的关系，简化了节点扩容和收缩难度  
+ 节点自身维护槽的映射关系，不需要客户端或者代理服务维护槽分区元数据  
+ 支持节点、槽、键之间的映射查询，用于数据路由、在线伸缩等场景  
集群功能限制  
redis集群相对单机在功能上存在一些限制  
+ key批量操作支持有限。如mset、mget，目前只支持具有相同slot值得key执行批量操作。对于映射为不同slot值得key由于执行mget、mset等操作可能存在多个节点上因此不被支持  
+ key事务操作支持有限。同理只支持多key在同一节点上的事务操作，当多个key分布在不同的节点上时无法使用事务功能  
+ key作为数据分区的最小粒度，因此不能将一个大的键值对象如hash、list等映射到不同的节点  
+ 不支持多数据库空间。单机下的redis可以支持16个数据库，集群模式下只能使用一个数据库空间，即db0  
+ 复制结构只支持一层，从节点只能复制主节点，不支持嵌套树状复制结构  
## 搭建集群  
集群模式最小需要6个redis节点  




